<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>Mediachain (aleph) Class: P2PNode</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.lumen.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top ">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">Mediachain (aleph)</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-common_util.html">common/util</a></li><li><a href="module-metadata_schema.html">metadata/schema</a></li><li><a href="module-peer.html">peer</a></li><li><a href="module-peer_datastore.html">peer/datastore</a></li><li><a href="module-peer_identity.html">peer/identity</a></li><li><a href="module-peer_merge.html">peer/merge</a></li><li><a href="module-peer_push.html">peer/push</a></li><li><a href="module-peer_util.html">peer/util</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="MediachainNode.html">MediachainNode</a></li><li><a href="module-peer_datastore-Datastore.html">peer/datastore~Datastore</a></li><li><a href="module-peer_identity-PrivateSigningKey.html">peer/identity~PrivateSigningKey</a></li><li><a href="module-peer_identity-PublicSigningKey.html">peer/identity~PublicSigningKey</a></li><li><a href="module-peer_identity-PublisherId.html">peer/identity~PublisherId</a></li><li><a href="P2PNode.html">P2PNode</a></li><li><a href="StatementDB.html">StatementDB</a></li>
				</ul>
			</li>
			
		</ul>
        
            <div class="col-sm-3 col-md-3">
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                        <div class="input-group-btn">
                            <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                        </div>
                    </div>
                </form>
            </div>
        
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-8">
	
		<div id="main">
			

	<h1 class="page-title">Class: P2PNode</h1>
<section>

<header>
    
        <h2>
        P2PNode
        </h2>
        
            <div class="class-description"><p>An object that acts as a LibP2P peer.  Provides promise-based interfaces
for opening and closing streams to other peers, (see <a href="P2PNode.html#dialByPeerInfo">P2PNode#dialByPeerInfo</a> and <a href="P2PNode.html#hangUpByPeerInfo">P2PNode#hangUpByPeerInfo</a>)
as well as handling named protocols (see <a href="P2PNode.html#handle">P2PNode#handle</a>).</p>
<p>A newly-constructed <code>P2PNode</code> handles a single protocol, the libp2p standard Ping protocol.
You can ping another libp2p node (including IPFS nodes) with <a href="P2PNode.html#ping">P2PNode#ping</a>.</p>
<p><code>P2PNode</code>s begin offline, and you must call <a href="P2PNode.html#start">P2PNode#start</a> to take them online.</p>
<p>A <code>PeerInfo</code> object with at least one multiaddr is required when constructing a <code>P2PNode</code>.
The node will attempt to listen on all tcp and / or websocket multiaddrs contained in the <code>PeerInfo</code>.
The node must be listening on a transport in order to dial with it; if no websocket listen
addresses are provided, you won't be able to dial to a peer using websockets.  Note that concat
nodes only support tcp transports, so that's probably what you want to use.</p></div>
        
    
</header>


<article>
    <div class="container-overview">
    
        
<hr>
<dt>
    <h4 class="name" id="P2PNode"><span class="type-signature"></span>new P2PNode(options)</h4>
    
    
</dt>
<dd>

    
    <div class="description">
        <p>Create a P2PNode.</p>
    </div>
    

    

    

    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">P2PNodeOptions</span>



            
            </td>

            

            

            <td class="description last">
                <h6 class="method-params-label method-subparams-label">Properties</h6>
                

<table class="params table table-striped">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Argument</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>peerInfo</code></td>
            

            <td class="type">
            
                
<span class="param-type">PeerInfo</span>



            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>A libp2p PeerInfo object that identifies a peer.
 Must contain at least one valid multiaddr for the node to listen on.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>peerBook</code></td>
            

            <td class="type">
            
                
<span class="param-type">PeerBook</span>



            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>An optional PeerBook object to &quot;pre-seed&quot; the node with mappings from PeerId to PeerInfo.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>disableSecureIO</code></td>
            

            <td class="type">
            
                
<span class="param-type">boolean</span>



            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    false
                
                </td>
            

            <td class="description last"><p>If true, disables encryption for streams opened by the node. Use for testing only.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>timeout</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>



            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    10000
                
                </td>
            

            <td class="description last"><p>Timeout in milliseconds to wait when dialing a peer before erroring out.
 Default is 10000 (10s) if this option is not present.</p></td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>

    

    
<dl class="details">
    

	

	

	

    

    

    

    

	

	

	

	

	



	

	

	

	
</dl>


    

    

    

    

    

    

    
</dd>

    
    </div>

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        <dl>
            
<hr>
<dt>
    <h4 class="name" id="dialByPeerInfo"><span class="type-signature"></span>dialByPeerInfo(peer, protocol)</h4>
    
    
</dt>
<dd>

    
    <div class="description">
        <p>Connect to a <code>peer</code>, opening a stream named by the <code>protocol</code> string.</p>
    </div>
    

    

    

    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>peer</code></td>
            

            <td class="type">
            
                
<span class="param-type">PeerInfo</span>



            
            </td>

            

            

            <td class="description last"><p>a <code>PeerInfo</code> object with at least one valid multiaddr for the node you want to dial.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>protocol</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>



            
            </td>

            

            

            <td class="description last"><p>a string identifying a P2P protocol, e.g. <code>&quot;/mediachain/node/query&quot;</code></p></td>
        </tr>

    
    </tbody>
</table>

    

    
<dl class="details">
    

	

	

	

    

    

    

    

	

	

	

	

	



	

	

	

	
</dl>


    

    

    

    

    

    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>resolves to a libp2p Connection, which can be used in a pull-stream.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Connection></span>



    </dd>
</dl>


        

    
</dd>

        
            
<hr>
<dt>
    <h4 class="name" id="handle"><span class="type-signature"></span>handle(protocol, handler)</h4>
    
    
</dt>
<dd>

    
    <div class="description">
        <p>Register a <code>handler</code> for the named <code>protocol</code>.</p>
    </div>
    

    

    

    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>protocol</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>



            
            </td>

            

            

            <td class="description last"><p>a string identifying a libp2p protocol, e.g. <code>&quot;/mediachain/node/query&quot;</code></p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>handler</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>



            
            </td>

            

            

            <td class="description last"><p>a function that will be called with the name of the protocol and a libp2p Connection
for incoming streams.</p></td>
        </tr>

    
    </tbody>
</table>

    

    
<dl class="details">
    

	

	

	

    

    

    

    

	

	

	

	

	



	

	

	

	
</dl>


    

    

    

    

    

    

    
</dd>

        
            
<hr>
<dt>
    <h4 class="name" id="hangUpByPeerInfo"><span class="type-signature"></span>hangUpByPeerInfo(peer)</h4>
    
    
</dt>
<dd>

    
    <div class="description">
        <p>Close all open streams to the given peer.</p>
    </div>
    

    

    

    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>peer</code></td>
            

            <td class="type">
            
                
<span class="param-type">PeerInfo</span>



            
            </td>

            

            

            <td class="description last"><p>a <code>PeerInfo</code> object identifying a peer with open streams.</p></td>
        </tr>

    
    </tbody>
</table>

    

    
<dl class="details">
    

	

	

	

    

    

    

    

	

	

	

	

	



	

	

	

	
</dl>


    

    

    

    

    

    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>resolves with no value on success, or rejects with an
<code>Error</code> if one occurs during the hang up operation.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>



    </dd>
</dl>


        

    
</dd>

        
            
<hr>
<dt>
    <h4 class="name" id="newAbortable"><span class="type-signature"></span>newAbortable()</h4>
    
    
</dt>
<dd>

    
    <div class="description">
        <p>Creates and returns a pull-stream &quot;abortable&quot;, which can be
added to a pull-stream pipeline to allow aborting the stream
at any time. All abortables returned from this method will be
aborted when the node is <a href="P2PNode.html#stop">stopped</a></p>
    </div>
    

    

    

    
    

    
<dl class="details">
    

	

	

	

    

    

    

    

	

	

	

	

	



	

	

	

	
</dl>


    

    

    

    

    

    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>a pull-stream abortable.  Call <code>.abort()</code> to cancel
a stream that passes through the abortable.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Abortable</span>



    </dd>
</dl>


        

    
        <h5>Example</h5>
        
    <pre class="sunlight-highlight-javascript">const abortable = myNode.newAbortable()
pull(
  connectionToOtherNode,
  abortable,
  handleLongRunningProcess(),
)

// later...
abortable.abort() // -&gt; closes the stream</pre>


    
</dd>

        
            
<hr>
<dt>
    <h4 class="name" id="ping"><span class="type-signature"></span>ping(peer)</h4>
    
    
</dt>
<dd>

    
    <div class="description">
        <p>Send a libp2p Ping message to the given <code>peer</code> and wait for a response.</p>
    </div>
    

    

    

    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>peer</code></td>
            

            <td class="type">
            
                
<span class="param-type">PeerInfo</span>



            
            </td>

            

            

            <td class="description last"><p>a <code>PeerInfo</code> for a peer, with at least one valid multiaddr.</p></td>
        </tr>

    
    </tbody>
</table>

    

    
<dl class="details">
    

	

	

	

    

    

    

    

	

	

	

	

	



	

	

	

	
</dl>


    

    

    

    

    

    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <ul>
<li>resolves to the latency (in msec), or rejects
with an <code>Error</code> if the ping fails.</li>
</ul>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;number></span>



    </dd>
</dl>


        

    
</dd>

        
            
<hr>
<dt>
    <h4 class="name" id="setSecureIOEnabled"><span class="type-signature"></span>setSecureIOEnabled( [use])</h4>
    
    
</dt>
<dd>

    
    <div class="description">
        <p>Set whether to use encrypted streams for communication with other nodes.
The default is true, and should usually be left alone. Disabling secure IO
is useful during unit testing, where security isn't a concern and the overhead
of encryption can slow down test execution.</p>
<p>Note that a node with secure IO disabled cannot communicate with a node that
requires secure IO.</p>
    </div>
    

    

    

    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Argument</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>use</code></td>
            

            <td class="type">
            
                
<span class="param-type">boolean</span>



            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    true
                
                </td>
            

            <td class="description last"><p>true to enable encryption, false to disable</p></td>
        </tr>

    
    </tbody>
</table>

    

    
<dl class="details">
    

	

	

	

    

    

    

    

	

	

	

	

	



	

	

	

	
</dl>


    

    

    

    

    

    

    
</dd>

        
            
<hr>
<dt>
    <h4 class="name" id="start"><span class="type-signature"></span>start()</h4>
    
    
</dt>
<dd>

    
    <div class="description">
        <p>Start the node, bringing it online.  This causes the node to listen on
all available transports, and allows the node to dial out to other peers.</p>
    </div>
    

    

    

    
    

    
<dl class="details">
    

	

	

	

    

    

    

    

	

	

	

	

	



	

	

	

	
</dl>


    

    

    

    

    

    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>resolves with no value on success, or rejects with an
<code>Error</code> if the node can't be started.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;void></span>



    </dd>
</dl>


        

    
</dd>

        
            
<hr>
<dt>
    <h4 class="name" id="stop"><span class="type-signature"></span>stop()</h4>
    
    
</dt>
<dd>

    
    <div class="description">
        <p>Stop the node, taking it offline.
This will cancel any &quot;abortables&quot; returned from <a href="P2PNode.html#newAbortable">P2PNode#newAbortable</a>,
and close any open transports.</p>
<p>Note that this may take several seconds using the TCP transport, even if there
are no streams open.</p>
    </div>
    

    

    

    
    

    
<dl class="details">
    

	

	

	

    

    

    

    

	

	

	

	

	



	

	

	

	
</dl>


    

    

    

    

    

    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>resolves with no value on success, or rejects with an <code>Error</code>
if the node can't be stopped.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;void></span>



    </dd>
</dl>


        

    
</dd>

        
            
<hr>
<dt>
    <h4 class="name" id="unhandle"><span class="type-signature"></span>unhandle(protocol)</h4>
    
    
</dt>
<dd>

    
    <div class="description">
        <p>Remove any handlers registered for the named <code>protocol</code></p>
    </div>
    

    

    

    
    
        <h5>Parameters:</h5>
        

<table class="params table table-striped">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>protocol</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>



            
            </td>

            

            

            <td class="description last"><p>a string identifying a previously handled protocol.</p></td>
        </tr>

    
    </tbody>
</table>

    

    
<dl class="details">
    

	

	

	

    

    

    

    

	

	

	

	

	



	

	

	

	
</dl>


    

    

    

    

    

    

    
</dd>

        </dl>
    

    

    
</article>

</section>




		</div>
	</div>

	<div class="clearfix"></div>

	
		<div class="col-md-3">
			<div id="toc" class="col-md-3 hidden-xs hidden-sm hidden-md"></div>
		</div>
	

</div>
</div>


    <div class="modal fade" id="searchResults">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Search results</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div>


<footer>


<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a>
	
		on 2017-02-10T11:59:41-05:00
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>

    <script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>


<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre, pre.prettyprint.source" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : false,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			return $( heading ).attr( "id" ) || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->



    <script type="text/javascript">
        $(document).ready(function() {
            SearcherDisplay.init();
        });
    </script>


</body>
</html>